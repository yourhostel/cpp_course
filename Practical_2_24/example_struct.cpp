#include <iostream>
#include <fstream>

using namespace std;

// Опис структури student, яка буде безпосередньо зберігатися у бінарному файлі
struct student {
    char name[15]; // Масив символів для прізвища студента (15 байтів)
    int age;       // Вік студента (звичайно 4 байти)
    bool gender;   // Стать студента (1 - чол, 0 - жінка), офіційно 1 байт (але можливий паддінг)
};

int main() {
    int n, i;
    student S;

    // --- Ввід кількості студентів ---
    cout << "Скільки студентів? ";
    cin >> n;

    // --- Відкриття бінарного файлу для запису ---
    // Відкриваємо файл у бінарному режимі для зберігання структур student
    ofstream fout("students.dat", ios::binary);
    if (!fout) {
        cout << "Не вдалося відкрити файл." << endl;
        return 1;
    }

    // --- Ввід даних про студентів та запис у файл ---
    cout << "Введіть дані про " << n << " студентів:" << endl;
    for (i = 0; i < n; i++) {
        // Ввід полів структури student з консолі
        cout << "Прізвище: ";
        cin >> S.name;

        cout << "Вік: ";
        cin >> S.age;

        cout << "Стать (1 - ч, 0 - ж): ";
        cin >> S.gender;

        // --- Запис структури student у бінарний файл ---
        // Пишемо байтове представлення структури S у файл
        // (char*)&S — приводимо адресу структури до типу char* (вказівник на масив байтів)
        // sizeof(student) — вказуємо скільки саме байтів потрібно записати
        fout.write(reinterpret_cast<char*>(&S), sizeof(student));
    }

    fout.close(); // Закриваємо файл після запису, щоб flush-нути буфер і завершити операцію
    cout << endl << "Дані записано у файл.";

    // --- Відкриття файлу для читання ---
    ifstream fin("students.dat", ios::binary);
    if (!fin) {
        cout << "Не вдалося відкрити файл." << endl;
        return 1;
    }

    cout << endl << "Файл зчитано!" << endl;

    // --- Зчитування структур student з бінарного файлу ---
    // Зчитуємо блоками розміром sizeof(student) прямо у пам'ять структури S
    while (fin.read(reinterpret_cast<char*>(&S), sizeof(student))) {
        // Перевіряємо умову: якщо студент — чоловік (gender == 1) і старше 20 років
        if (S.gender && S.age > 20) {
            // Виводимо ім'я студента, його вік і коментар що це "чол"
            cout << S.name << " " << S.age << " чол" << endl;
        }
    }

    fin.close(); // Закриваємо файл після завершення читання

    return 0;
}
